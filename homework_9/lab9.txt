Q1: db.zipcode.aggregate([{$match:{state:"IA"}},{$group: {_id:"$_id"}},{$sort: {_id:1}}])
Q2: db.zipcode.aggregate([{$match: {pop: {$lt: 1000}}},{$project: {_id:0, zipcode:"$_id",state:1}}])
Q3: db.zipcode.aggregate([{$group: {_id:{city:"$city",state:"$state"}, num_zipcode: {$sum:1}}},{$match: {num_zipcode:{$gte:2}}},{$sort: {state:1,city:1}}])
Q4: db.zipcode.aggregate([{$group: {'_id': {'city': '$city', 'state': '$state'},'population': {$sum: '$pop'}}},{$sort: {'population': -1}},{$group: {'_id': '$_id.state', 'city': {$first: '$_id.city'}, 'population': {$first: '$population'}}},{$sort: {'_id': -1}}])
